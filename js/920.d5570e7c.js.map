{"version":3,"file":"js/920.d5570e7c.js","mappings":"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","sources":["webpack://vue-shopping/./src/views/prodetail/index.vue","webpack://vue-shopping/./src/mixins/loginConfirm.js","webpack://vue-shopping/src/views/prodetail/index.vue","webpack://vue-shopping/./src/views/prodetail/index.vue?f133","webpack://vue-shopping/./src/views/prodetail/index.vue?3c54","webpack://vue-shopping/./src/api/product.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"index\"},[_c('van-nav-bar',{attrs:{\"title\":\"商品詳情頁\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onClickLeft}}),_c('van-swipe',{staticClass:\"swipeBox\",on:{\"change\":_vm.onChange}},[_vm._l((_vm.images),function(image){return _c('van-swipe-item',{key:image.file_id},[_c('img',{attrs:{\"src\":image.external_url,\"alt\":\"\"}})])}),_c('div',{staticClass:\"custom-indicator\",attrs:{\"slot\":\"indicator\"},slot:\"indicator\"},[_vm._v(\" \"+_vm._s(_vm.current + 1)+\"/\"+_vm._s(_vm.images.length)+\" \")])],2),_c('div',{staticClass:\"messages\"},[_c('div',{staticClass:\"priceSales\"},[_c('div',{staticClass:\"price\"},[_c('div',{staticClass:\"priceMin\"},[_vm._v(\"$\"+_vm._s(_vm.detail.goods_price_min))]),_c('div',{staticClass:\"priceMax\"},[_vm._v(\"$\"+_vm._s(_vm.detail.goods_price_max))])]),_c('div',{staticClass:\"sales\"},[_vm._v(\"已售\"+_vm._s(_vm.detail.goods_sales)+\"件\")])]),_c('div',{staticClass:\"goodsName\"},[_vm._v(\" \"+_vm._s(_vm.detail.goods_name)+\" \")]),_c('div',{staticClass:\"sevenday\"},[_c('div',[_c('van-icon',{attrs:{\"name\":\"passed\",\"color\":\"red\"}}),_c('span',[_vm._v(\"七天無理由退貨\")])],1),_c('div',[_c('van-icon',{attrs:{\"name\":\"passed\",\"color\":\"red\"}}),_c('span',[_vm._v(\"48小時發貨\")])],1)])]),_c('div',{staticClass:\"comments\"},[_c('div',{staticClass:\"titles\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"商品評價(\"+_vm._s(_vm.total)+\"條)\")]),_c('div',{staticClass:\"more\"},[_vm._v(\"查看更多\"),_c('van-icon',{attrs:{\"name\":\"arrow\",\"color\":\"#999\"}})],1)]),_c('div',{staticClass:\"commentItemBox\"},_vm._l((_vm.commentList),function(item){return _c('div',{key:item.comment_id,staticClass:\"commentItem\"},[_c('div',{staticClass:\"titles\"},[_c('div',{staticClass:\"img\"},[_c('img',{attrs:{\"src\":item.user.avatar_url || _vm.defaultImg,\"alt\":\"\"}})]),_c('p',{staticClass:\"names\"},[_vm._v(_vm._s(item.user.nick_name))]),_c('van-rate',{attrs:{\"value\":item.score/4,\"readonly\":\"\",\"allow-half\":\"\"}})],1),_c('div',{staticClass:\"content\"},[_vm._v(\" \"+_vm._s(item.content)+\" \")]),_c('div',{staticClass:\"time\"},[_vm._v(\" \"+_vm._s(item.create_time)+\" \")])])}),0)]),_c('div',{staticClass:\"imgBox\",domProps:{\"innerHTML\":_vm._s(_vm.detail.content)}}),_c('div',{staticClass:\"floorHight\"}),_c('div',{staticClass:\"floor\"},[_c('div',{on:{\"click\":function($event){return _vm.$router.push('/')}}},[_c('van-icon',{attrs:{\"name\":\"wap-home-o\",\"size\":\"1.8em\"}}),_c('p',[_vm._v(\"首頁\")])],1),_c('div',{staticClass:\"cartButton\",on:{\"click\":function($event){return _vm.$router.push('/shopping')}}},[(_vm.cartTotalNow > 0)?_c('div',{staticClass:\"cartTotal\"},[_vm._v(_vm._s(_vm.cartTotalNow || 0))]):_vm._e(),_c('van-icon',{attrs:{\"name\":\"shopping-cart-o\",\"size\":\"1.8em\"}}),_c('p',[_vm._v(\"購物車\")])],1),_c('button',{staticClass:\"inCart\",on:{\"click\":_vm.addFn}},[_vm._v(\"加入購物車\")]),_c('button',{staticClass:\"buyNow\",on:{\"click\":_vm.buyNow}},[_vm._v(\"立刻購買\")])]),_c('van-action-sheet',{staticClass:\"sheetBox\",attrs:{\"title\":_vm.mode === 'cart' ? '加入購物車' : '立刻購買'},model:{value:(_vm.showPannel),callback:function ($$v) {_vm.showPannel=$$v},expression:\"showPannel\"}},[_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"title\"},[_c('div',{staticClass:\"img\"},[_c('img',{attrs:{\"src\":_vm.detail.goods_image,\"alt\":\"\"}})]),_c('div',[_c('p',{staticClass:\"price\"},[_vm._v(\"$\"+_vm._s(_vm.detail.goods_price_min))]),_c('p',{staticClass:\"total\"},[_vm._v(\"庫存\"+_vm._s(_vm.detail.stock_total))])])]),_c('div',{staticClass:\"count\"},[_c('div',[_vm._v(\"數量\")]),_c('CountBox',{model:{value:(_vm.addCount),callback:function ($$v) {_vm.addCount=$$v},expression:\"addCount\"}})],1),_c('div',{staticClass:\"toGoButton\"},[(_vm.mode === 'cart')?_c('button',{on:{\"click\":_vm.addCart}},[_vm._v(\"加入購物車\")]):_c('button',{on:{\"click\":_vm.goBuyNow}},[_vm._v(\"立刻購買\")])])])])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default {\r\n  methods: {\r\n    // 是否需要登入\r\n    // (1) 需要，返回 true\r\n    // (2) 不需要，返回 false\r\n    loginConfirm () {\r\n      if (!this.$store.getters.token) {\r\n        this.$dialog.confirm({\r\n          title: '溫馨提示',\r\n          message: '此處須先登入才能繼續操作',\r\n          confirmButtonText: '去登錄',\r\n          cancelButtonText: '再逛逛'\r\n        })\r\n          .then(() => {\r\n            // 傳送當前地址才能再傳回來\r\n            // this.$route.fullPath (包含查詢參數)\r\n            this.$router.replace({\r\n              path: '/login',\r\n              query: {\r\n                backUrl: this.$route.fullPath\r\n              }\r\n            })\r\n          })\r\n          // cancelButton在逛逛的點擊事件\r\n          .catch(() => {})\r\n        return true\r\n      }\r\n      return false\r\n    }\r\n  }\r\n}\r\n","<template>\r\n  <div class=\"index\">\r\n    <!-- 標題 -->\r\n    <van-nav-bar\r\n      title=\"商品詳情頁\"\r\n      left-arrow\r\n      @click-left=\"onClickLeft\"\r\n    />\r\n    <!-- 輪播圖 -->\r\n    <van-swipe class=\"swipeBox\" @change=\"onChange\">\r\n      <van-swipe-item v-for=\"image in images\" :key=\"image.file_id\"><img :src=\"image.external_url\" alt=\"\"></van-swipe-item>\r\n      <div class=\"custom-indicator\" slot=\"indicator\">\r\n        {{ current + 1 }}/{{ images.length }}\r\n      </div>\r\n    </van-swipe>\r\n    <!-- 訊息 -->\r\n    <div class=\"messages\">\r\n      <div class=\"priceSales\">\r\n        <div class=\"price\">\r\n          <div class=\"priceMin\">${{ detail.goods_price_min }}</div>\r\n          <div class=\"priceMax\">${{ detail.goods_price_max }}</div>\r\n        </div>\r\n        <div class=\"sales\">已售{{ detail.goods_sales }}件</div>\r\n      </div>\r\n      <div class=\"goodsName\">\r\n        {{ detail.goods_name }}\r\n      </div>\r\n      <div class=\"sevenday\">\r\n        <div><van-icon name=\"passed\" color=\"red\" /><span>七天無理由退貨</span></div>\r\n        <div><van-icon name=\"passed\" color=\"red\"/><span>48小時發貨</span></div>\r\n      </div>\r\n    </div>\r\n    <!-- 商品評價 -->\r\n    <div class=\"comments\">\r\n      <div class=\"titles\">\r\n        <div class=\"title\">商品評價({{ total }}條)</div>\r\n        <div class=\"more\">查看更多<van-icon name=\"arrow\" color=\"#999\"/></div>\r\n      </div>\r\n      <div class=\"commentItemBox\">\r\n        <div class=\"commentItem\" v-for=\"item in commentList\" :key=\"item.comment_id\">\r\n          <div class=\"titles\">\r\n            <div class=\"img\">\r\n              <img :src=\"item.user.avatar_url || defaultImg\" alt=\"\">\r\n            </div>\r\n            <p class=\"names\">{{ item.user.nick_name }}</p>\r\n            <van-rate :value=\"item.score/4\" readonly  allow-half/>\r\n          </div>\r\n          <div class=\"content\">\r\n            {{ item.content }}\r\n          </div>\r\n          <div class=\"time\">\r\n            {{ item.create_time }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 圖片 -->\r\n      <div class=\"imgBox\" v-html=\"detail.content\"></div>\r\n    <!-- 底部導覽按鈕fixed定位 -->\r\n    <div class=\"floorHight\"></div>\r\n    <div class=\"floor\">\r\n      <div @click=\"$router.push('/')\">\r\n        <van-icon name=\"wap-home-o\" size=\"1.8em\"/>\r\n        <p>首頁</p>\r\n      </div>\r\n      <div class=\"cartButton\" @click=\"$router.push('/shopping')\">\r\n        <div v-if=\"cartTotalNow > 0\" class=\"cartTotal\">{{ cartTotalNow || 0 }}</div>\r\n        <van-icon name=\"shopping-cart-o\" size=\"1.8em\"/>\r\n        <p>購物車</p>\r\n      </div>\r\n      <button class=\"inCart\" @click=\"addFn\">加入購物車</button>\r\n      <button class=\"buyNow\" @click=\"buyNow\">立刻購買</button>\r\n    </div>\r\n    <van-action-sheet class=\"sheetBox\" v-model=\"showPannel\" :title=\"mode === 'cart' ? '加入購物車' : '立刻購買'\">\r\n      <div class=\"content\">\r\n        <div class=\"title\">\r\n          <div class=\"img\">\r\n            <img :src=\"detail.goods_image\" alt=\"\">\r\n          </div>\r\n          <div>\r\n            <p class=\"price\">${{ detail.goods_price_min }}</p>\r\n            <p class=\"total\">庫存{{ detail.stock_total }}</p>\r\n          </div>\r\n        </div>\r\n      <div class=\"count\">\r\n        <div>數量</div>\r\n        <CountBox v-model=\"addCount\"></CountBox>\r\n      </div>\r\n      <div class=\"toGoButton\">\r\n        <button v-if=\"mode === 'cart'\" @click=\"addCart\">加入購物車</button>\r\n        <button v-else @click=\"goBuyNow\">立刻購買</button>\r\n      </div>\r\n      </div>\r\n    </van-action-sheet>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getProDetail, getProComments } from '@/api/product.js'\r\nimport { addCart } from '@/api/cart'\r\nimport defaultImg from '@/assets/logo.png'\r\nimport CountBox from '@/components/CountBox.vue'\r\nimport { mapGetters } from 'vuex'\r\nimport loginConfirm from '@/mixins/loginConfirm.js'\r\n\r\nexport default {\r\n  name: 'prodetailIndex',\r\n  mixins: [loginConfirm],\r\n  components: { CountBox },\r\n  data () {\r\n    return {\r\n      current: 0, // vant輪播圖當前頁數\r\n      detail: {}, // 獲取的整體數據\r\n      images: [], // 獲取的輪播圖\r\n      total: 0, // 評價總數\r\n      commentList: [], // 評價列表\r\n      defaultImg, // 評價預設頭像\r\n      showPannel: false, // 彈層顯示與隱藏\r\n      mode: 'cart', // 彈層狀態\r\n      addCount: 1, // 父傳子彈層商品數量\r\n      cartTotalNow: 0 // 購物車商品數量\r\n    }\r\n  },\r\n  computed: {\r\n    goodsId () {\r\n      return this.$route.params.id // 路由傳參id\r\n    },\r\n    ...mapGetters('cart', ['cartTotal']) // vuex購物車商品數量\r\n  },\r\n  created () {\r\n    // // 確認登入狀態後調用模塊的actions要用dispatch\r\n    // if (this.$store.getters.token) {\r\n    //   this.$store.dispatch('cart/getCartAction')\r\n    // }\r\n    this.getDetail()\r\n    this.getComments()\r\n    this.gocartTotalNow()\r\n  },\r\n  methods: {\r\n    gocartTotalNow () {\r\n      if (this.cartTotal) {\r\n        this.cartTotalNow = this.cartTotal\r\n      }\r\n    },\r\n    // vant輪播圖頁數更變\r\n    onChange (index) {\r\n      this.current = index\r\n    },\r\n    onClickLeft () {\r\n      this.$router.go(-1)\r\n    },\r\n    async getDetail () {\r\n      const { data: { detail } } = await getProDetail(this.goodsId)\r\n      this.detail = detail\r\n      this.images = detail.goods_images\r\n    },\r\n    async getComments () {\r\n      const { data: { list, total } } = await getProComments(this.goodsId, 3)\r\n      this.commentList = list\r\n      this.total = total\r\n    },\r\n    // 加入購物車事件\r\n    addFn () {\r\n      this.mode = 'cart'\r\n      this.showPannel = true\r\n    },\r\n    // 立刻購買事件\r\n    buyNow () {\r\n      this.mode = 'buyNow'\r\n      this.showPannel = true\r\n    },\r\n    // 加入購物車按鈕的登入確認\r\n    async addCart () {\r\n      // if (!this.$store.getters.token) {\r\n      //   return this.$dialog.confirm({\r\n      //     title: '溫馨提示',\r\n      //     message: '此處須先登入才能繼續操作',\r\n      //     confirmButtonText: '去登錄',\r\n      //     cancelButtonText: '再逛逛'\r\n      //   })\r\n      //     .then(() => {\r\n      //       // confirmButton的點擊事件\r\n      //       this.$router.push({\r\n      //         path: '/login',\r\n      //         query: {\r\n      //           backUrl: this.$route.fullPath\r\n      //         }\r\n      //       })\r\n      //     })\r\n      //     // cancelButton在逛逛的點擊事件\r\n      //     .catch(() => {\r\n      //     })\r\n      // }\r\n      // 把以上的登入確認移至mixins重複使用_在加入購物車事件中使用mixins\r\n      if (this.loginConfirm()) {\r\n        return\r\n      }\r\n      const { data } = await addCart(this.goodsId, this.addCount, this.detail.skuList[0].goods_sku_id)\r\n      this.cartTotalNow = data.cartTotal\r\n      this.$toast('加入購物車成功')\r\n      this.showPannel = false\r\n    },\r\n    // 跳轉訂單頁面並傳參\r\n    goBuyNow () {\r\n      // 在立刻購買事件中使用mixins\r\n      if (this.loginConfirm()) {\r\n        return\r\n      }\r\n      this.$router.push({\r\n        path: '/pay',\r\n        query: {\r\n          mode: 'buyNow',\r\n          goodsId: this.goodsId,\r\n          goodsSkuId: this.detail.skuList[0].goods_sku_id,\r\n          goodsNum: this.addCount\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.swipeBox{\r\n  position: relative;\r\n  .van-swipe-item{\r\n    img{\r\n      width: 0;\r\n    }\r\n  }\r\n  .custom-indicator{\r\n    position: absolute;\r\n    bottom: 10px;\r\n    right: 15px;\r\n    padding: 3px 8px;\r\n    color: #fff;\r\n    background-color: rgba(179, 179, 179, 0.6);\r\n    border-radius: 8px;\r\n  }\r\n}\r\n.messages{\r\n  margin: 20px 10px;\r\n  .priceSales{\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    .price{\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      .priceMin{\r\n        font-size: 1.5em;\r\n        color: rgb(255, 55, 0);\r\n        margin-right: 5px;\r\n      }\r\n      .priceMax{\r\n        text-decoration: line-through;\r\n        color: #999;\r\n      }\r\n    }\r\n    .sales{\r\n      color: #999;\r\n    }\r\n  }\r\n  .goodsName{\r\n    text-align: left;\r\n    margin-top: 10px;\r\n    overflow: hidden;\r\n    display: -webkit-box; /* 彈性伸縮盒子(多行時省略號使用) */\r\n    -webkit-line-clamp: 2; /* 盒子行數(多行時省略號使用) */\r\n    -webkit-box-orient: vertical; /* 盒子排列方式(多行時省略號使用) */\r\n  }\r\n  .sevenday{\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    div:nth-child(1){\r\n      margin-right: 5px;\r\n    }\r\n  }\r\n}\r\n.comments{\r\n  padding: 0 10px;\r\n  .titles{\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    .more{\r\n      color: #999;\r\n    }\r\n  }\r\n  .commentItemBox{\r\n    padding: 10px;\r\n    .commentItem{\r\n      margin: 10px 0 20px 0;\r\n      padding: 10px;\r\n      border: 1px double #999;\r\n      border-radius: 10px;\r\n      .titles{\r\n        display: flex;\r\n        justify-content: flex-start;\r\n        align-items: center;\r\n        .img{\r\n          width: 1em;\r\n          margin-right: 5px;\r\n        }\r\n        .names{\r\n          margin-right: 5px;\r\n        }\r\n      }\r\n      .content{\r\n        width: calc(100% - 10px);\r\n        margin: 5px 0;\r\n        text-align: left;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n      }\r\n      .time{\r\n        color: #999;\r\n        text-align: left;\r\n      }\r\n    }\r\n  }\r\n}\r\n.imgBox{\r\n  overflow: hidden;\r\n  width: calc(100vw - 20px);\r\n  margin: 10px;\r\n}\r\n.floorHight{\r\n  height: 80px;\r\n}\r\n.floor{\r\n    position: fixed;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100vw;\r\n    padding: 10px;\r\n    border-top: 1px solid black;\r\n    background-color: #fff;\r\n    .cartButton{\r\n      position: relative;\r\n      .cartTotal{\r\n        z-index: 999;\r\n        position: absolute;\r\n        top: -2px;\r\n        right: -2px;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        padding: 3px 5px;\r\n        font-size: 0.8em;\r\n        color: #fff;\r\n        background-color: red;\r\n        border-radius: 20px;\r\n      }\r\n    }\r\n    button{\r\n      border: 0;\r\n      border-radius: 20px;\r\n      padding: 10px 25px;\r\n      color: #fff;\r\n    }\r\n    button:nth-child(3){\r\n      background-color: orange;\r\n    }\r\n    button:nth-child(4){\r\n      background-color: red;\r\n    }\r\n  }\r\n  // 彈窗\r\n.sheetBox{\r\n  .content{\r\n    padding: 10px;\r\n    .title{\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      .img{\r\n        margin-right: 10px;\r\n        width: 120px;\r\n      }\r\n      .price{\r\n        font-size: 1.2em;\r\n        color: orange;\r\n      }\r\n      .total{\r\n        color: #999;\r\n      }\r\n    }\r\n    .count{\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n    }\r\n    .toGoButton{\r\n      button{\r\n        width: 90%;\r\n        margin-top: 30px;\r\n        padding: 10px 0;\r\n        color: #fff;\r\n        background-color: orange;\r\n        border: none;\r\n        border-radius: 30px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1311c526&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1311c526&prod&lang=less&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1311c526\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\r\n// 商品列表的商品\r\nexport const getProList = (obj) => {\r\n  const { categoryId, goodsName, page } = obj\r\n  return request.get('/goods/list', {\r\n    params: {\r\n      categoryId, // ID值\r\n      goodsName, // 商品名稱\r\n      page // 頁數\r\n    }\r\n  })\r\n}\r\n// 商品詳情頁\r\nexport const getProDetail = (goodsId) => {\r\n  return request.get('/goods/detail', {\r\n    params: {\r\n      goodsId\r\n    }\r\n  })\r\n}\r\n// 商品評價\r\nexport const getProComments = (goodsId, limit) => {\r\n  return request.get('/comment/listRows', {\r\n    params: {\r\n      goodsId,\r\n      limit\r\n    }\r\n  })\r\n}\r\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","onClickLeft","onChange","_l","images","image","key","file_id","external_url","slot","_v","_s","current","length","detail","goods_price_min","goods_price_max","goods_sales","goods_name","total","commentList","item","comment_id","user","avatar_url","defaultImg","nick_name","score","content","create_time","domProps","$event","$router","push","cartTotalNow","_e","addFn","buyNow","mode","model","value","showPannel","callback","$$v","expression","goods_image","stock_total","addCount","addCart","goBuyNow","staticRenderFns","methods","loginConfirm","$store","getters","token","$dialog","confirm","title","message","confirmButtonText","cancelButtonText","then","replace","path","query","backUrl","$route","fullPath","catch","name","mixins","components","CountBox","data","computed","goodsId","params","id","mapGetters","created","getDetail","getComments","gocartTotalNow","cartTotal","index","go","getProDetail","goods_images","list","getProComments","skuList","goods_sku_id","$toast","goodsSkuId","goodsNum","component","getProList","obj","categoryId","goodsName","page","request","get","limit"],"sourceRoot":""}