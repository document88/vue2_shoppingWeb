"use strict";(self["webpackChunkvue_shopping"]=self["webpackChunkvue_shopping"]||[]).push([[920],{5920:function(t,s,a){a.r(s),a.d(s,{default:function(){return h}});a(560);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"index"},[s("van-nav-bar",{attrs:{title:"商品詳情頁","left-arrow":""},on:{"click-left":t.onClickLeft}}),s("van-swipe",{staticClass:"swipeBox",on:{change:t.onChange}},[t._l(t.images,(function(t){return s("van-swipe-item",{key:t.file_id},[s("img",{attrs:{src:t.external_url,alt:""}})])})),s("div",{staticClass:"custom-indicator",attrs:{slot:"indicator"},slot:"indicator"},[t._v(" "+t._s(t.current+1)+"/"+t._s(t.images.length)+" ")])],2),s("div",{staticClass:"messages"},[s("div",{staticClass:"priceSales"},[s("div",{staticClass:"price"},[s("div",{staticClass:"priceMin"},[t._v("$"+t._s(t.detail.goods_price_min))]),s("div",{staticClass:"priceMax"},[t._v("$"+t._s(t.detail.goods_price_max))])]),s("div",{staticClass:"sales"},[t._v("已售"+t._s(t.detail.goods_sales)+"件")])]),s("div",{staticClass:"goodsName"},[t._v(" "+t._s(t.detail.goods_name)+" ")]),s("div",{staticClass:"sevenday"},[s("div",[s("van-icon",{attrs:{name:"passed",color:"red"}}),s("span",[t._v("七天無理由退貨")])],1),s("div",[s("van-icon",{attrs:{name:"passed",color:"red"}}),s("span",[t._v("48小時發貨")])],1)])]),s("div",{staticClass:"comments"},[s("div",{staticClass:"titles"},[s("div",{staticClass:"title"},[t._v("商品評價("+t._s(t.total)+"條)")]),s("div",{staticClass:"more"},[t._v("查看更多"),s("van-icon",{attrs:{name:"arrow",color:"#999"}})],1)]),s("div",{staticClass:"commentItemBox"},t._l(t.commentList,(function(a){return s("div",{key:a.comment_id,staticClass:"commentItem"},[s("div",{staticClass:"titles"},[s("div",{staticClass:"img"},[s("img",{attrs:{src:a.user.avatar_url||t.defaultImg,alt:""}})]),s("p",{staticClass:"names"},[t._v(t._s(a.user.nick_name))]),s("van-rate",{attrs:{value:a.score/4,readonly:"","allow-half":""}})],1),s("div",{staticClass:"content"},[t._v(" "+t._s(a.content)+" ")]),s("div",{staticClass:"time"},[t._v(" "+t._s(a.create_time)+" ")])])})),0)]),s("div",{staticClass:"imgBox",domProps:{innerHTML:t._s(t.detail.content)}}),s("div",{staticClass:"floorHight"}),s("div",{staticClass:"floor"},[s("div",{on:{click:function(s){return t.$router.push("/")}}},[s("van-icon",{attrs:{name:"wap-home-o",size:"1.8em"}}),s("p",[t._v("首頁")])],1),s("div",{staticClass:"cartButton",on:{click:function(s){return t.$router.push("/shopping")}}},[t.cartTotalNow>0?s("div",{staticClass:"cartTotal"},[t._v(t._s(t.cartTotalNow||0))]):t._e(),s("van-icon",{attrs:{name:"shopping-cart-o",size:"1.8em"}}),s("p",[t._v("購物車")])],1),s("button",{staticClass:"inCart",on:{click:t.addFn}},[t._v("加入購物車")]),s("button",{staticClass:"buyNow",on:{click:t.buyNow}},[t._v("立刻購買")])]),s("van-action-sheet",{staticClass:"sheetBox",attrs:{title:"cart"===t.mode?"加入購物車":"立刻購買"},model:{value:t.showPannel,callback:function(s){t.showPannel=s},expression:"showPannel"}},[s("div",{staticClass:"content"},[s("div",{staticClass:"title"},[s("div",{staticClass:"img"},[s("img",{attrs:{src:t.detail.goods_image,alt:""}})]),s("div",[s("p",{staticClass:"price"},[t._v("$"+t._s(t.detail.goods_price_min))]),s("p",{staticClass:"total"},[t._v("庫存"+t._s(t.detail.stock_total))])])]),s("div",{staticClass:"count"},[s("div",[t._v("數量")]),s("CountBox",{model:{value:t.addCount,callback:function(s){t.addCount=s},expression:"addCount"}})],1),s("div",{staticClass:"toGoButton"},["cart"===t.mode?s("button",{on:{click:t.addCart}},[t._v("加入購物車")]):s("button",{on:{click:t.goBuyNow}},[t._v("立刻購買")])])])])],1)},o=[],e=a(1787),n=a(6624),c=a(6949),l=a(3590),r=a(3822),d={methods:{loginConfirm(){return!this.$store.getters.token&&(this.$dialog.confirm({title:"溫馨提示",message:"此處須先登入才能繼續操作",confirmButtonText:"去登錄",cancelButtonText:"再逛逛"}).then((()=>{this.$router.replace({path:"/login",query:{backUrl:this.$route.fullPath}})})).catch((()=>{})),!0)}}},u={name:"prodetailIndex",mixins:[d],components:{CountBox:l.Z},data(){return{current:0,detail:{},images:[],total:0,commentList:[],defaultImg:c,showPannel:!1,mode:"cart",addCount:1,cartTotalNow:0}},computed:{goodsId(){return this.$route.params.id},...(0,r.Se)("cart",["cartTotal"])},created(){this.getDetail(),this.getComments(),this.gocartTotalNow()},methods:{gocartTotalNow(){this.cartTotal&&(this.cartTotalNow=this.cartTotal)},onChange(t){this.current=t},onClickLeft(){this.$router.go(-1)},async getDetail(){const{data:{detail:t}}=await(0,e.Aw)(this.goodsId);this.detail=t,this.images=t.goods_images},async getComments(){const{data:{list:t,total:s}}=await(0,e.U3)(this.goodsId,3);this.commentList=t,this.total=s},addFn(){this.mode="cart",this.showPannel=!0},buyNow(){this.mode="buyNow",this.showPannel=!0},async addCart(){if(this.loginConfirm())return;const{data:t}=await(0,n.Z5)(this.goodsId,this.addCount,this.detail.skuList[0].goods_sku_id);this.cartTotalNow=t.cartTotal,this.$toast("加入購物車成功"),this.showPannel=!1},goBuyNow(){this.loginConfirm()||this.$router.push({path:"/pay",query:{mode:"buyNow",goodsId:this.goodsId,goodsSkuId:this.detail.skuList[0].goods_sku_id,goodsNum:this.addCount}})}}},m=u,v=a(1001),g=(0,v.Z)(m,i,o,!1,null,"1311c526",null),h=g.exports},1787:function(t,s,a){a.d(s,{Aw:function(){return e},Fs:function(){return o},U3:function(){return n}});var i=a(4471);const o=t=>{const{categoryId:s,goodsName:a,page:o}=t;return i.Z.get("/goods/list",{params:{categoryId:s,goodsName:a,page:o}})},e=t=>i.Z.get("/goods/detail",{params:{goodsId:t}}),n=(t,s)=>i.Z.get("/comment/listRows",{params:{goodsId:t,limit:s}})}}]);
//# sourceMappingURL=920.d5570e7c.js.map